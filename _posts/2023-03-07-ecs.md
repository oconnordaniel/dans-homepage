---
title: Elastic Container
date: 2023-03-05 10:00:00 -700
catagories: [aws]
tags: [aws]
---


## Create cluster

``` bash
aws ecs create-cluster --cluster-name dans-homepage
aws ecs list-clusters
```

## Create Task definition

``` bash
aws ecs register-task-definition --cli-input-json file://`pwd`/task-definition.json
aws ecs list-task-definitions
```

``` json : task-definition.json
{
    "containerDefinitions": [
        {
            "name": "dans-homepage", 
            "image": "nginx:latest", 
            "portMappings": [
                {
                    "containerPort": 80, 
                    "hostPort": 80, 
                    "protocol": "tcp"
                }
            ]
        }
    ], 
    "memory": "512",
    "cpu": "256", 
    "networkMode": "awsvpc", 
    "family": "http-server", 
    "requiresCompatibilities": [
        "FARGATE"
    ]
}
```

## Create service

```bash
aws ec2 describe-subnets
aws ec2 describe-security-groups
```

Take note of the SubnetId
Take note of the GroupId

``` bash
aws ecs create-service \
--cluster dans-homepage \
--servive-name dans-homepage-service \
--task-definition dans-homepage:1 \
--desired-count 1 \
--launch-type "FARGATE" \
--network-configuration "awsvpcConfiguration={subnet=[<SubnetId>],securityGroups=[<GroupId>], assignPublicIp=ENABLED}"
```

aws ecs list-services --cluster-dans-homepage-service

aws ecs list-tasks --cluster dans-homepage-service
aws ecs describe-tasks --cluster dans-homepage-service --tasks "<arn>"
aws ec2 describe-network-interfaces --network-interface-id <eni->

## Resources

[video link](https://www.youtube.com/watch?v=9KWgTuQGEGQ&t=539s)
